# 🚀 دليل التثبيت الشامل - YouTubeTB

## 📋 نظرة عامة

هذا الدليل يشرح كيفية نقل المشروع من جهاز لآخر بشكل آمن وتثبيته على جهاز Windows جديد تماماً.

---

## 🔐 الخطوة 1: تشفير المفاتيح (على الجهاز القديم)

### لماذا التشفير؟
- حماية مفاتيح API من الوصول غير المصرح
- إمكانية رفع المشروع على GitHub بشكل آمن
- استخدام كلمة مرور واحدة لفك التشفير على الجهاز الجديد

### كيفية التشفير:

```batch
# 1. نفذ سكربت التشفير
python scripts\encrypt_secrets.py

# 2. ستُطلب منك كلمة مرور (احفظها جيداً!)
Enter encryption password: ********
Confirm password: ********

# 3. سيتم تشفير جميع الملفات في secrets/ إلى secrets_encrypted/
```

### الملفات التي يتم تشفيرها:
- ✅ `api_key.txt` - مفتاح Gemini API
- ✅ `cookies.txt` - ملفات تعريف ارتباط YouTube
- ✅ `client_secret.json` - بيانات OAuth لـ YouTube
- ✅ `token.json` - رمز الوصول لـ YouTube
- ✅ `.env` - متغيرات البيئة (إن وُجدت)

### بعد التشفير:
```batch
# 1. احذف مجلد secrets/ الأصلي (لا تدفعه لـ GitHub!)
# المجلد مُضاف بالفعل في .gitignore

# 2. ارفع المشروع على GitHub
git add .
git commit -m "Add encrypted secrets"
git push origin master
```

---

## 💻 الخطوة 2: التثبيت على جهاز جديد

### المتطلبات الأولية:
- جهاز Windows 10/11
- اتصال بالإنترنت
- صلاحيات المسؤول (Administrator)

### طريقة التثبيت السريعة:

#### الخيار أ: باستخدام ملف التثبيت الشامل ⭐ (موصى به)

```batch
# 1. حمّل ملف install_complete.bat فقط أو استنسخ المستودع
git clone https://github.com/YOUR_USERNAME/youtubetb-refactored.git
cd youtubetb-refactored

# 2. شغّل ملف التثبيت كـ Administrator
# انقر بالزر الأيمن → Run as administrator
install_complete.bat
```

**هذا الملف سينفذ تلقائياً:**
1. ✅ فحص/تثبيت Python 3.11+
2. ✅ تحميل وتثبيت FFmpeg
3. ✅ إضافة Python و FFmpeg لمتغير PATH
4. ✅ استنساخ المستودع (إذا لم يكن موجوداً)
5. ✅ إنشاء بيئة افتراضية (virtual environment)
6. ✅ تثبيت جميع المتطلبات من requirements.txt
7. ✅ تثبيت متصفحات Playwright
8. ✅ فك تشفير الأسرار (سيُطلب كلمة المرور)
9. ✅ التحقق من التثبيت

#### الخيار ب: التثبيت اليدوي

إذا أردت التحكم الكامل، اتبع الخطوات التالية:

##### 1. تثبيت Python 3.11+

```batch
# حمّل من الموقع الرسمي
https://www.python.org/downloads/

# تأكد من تفعيل:
☑️ Add Python to PATH
☑️ Install pip
```

##### 2. تثبيت FFmpeg

```batch
# الطريقة الأولى: Chocolatey (موصى بها)
choco install ffmpeg

# الطريقة الثانية: يدوياً
# 1. حمّل من: https://www.gyan.dev/ffmpeg/builds/
# 2. فك الضغط إلى C:\ffmpeg
# 3. أضف C:\ffmpeg\bin إلى PATH:
#    - ابحث عن "Environment Variables"
#    - System variables → Path → Edit → New
#    - أضف المسار: C:\ffmpeg\bin
```

##### 3. استنساخ المستودع

```batch
git clone https://github.com/YOUR_USERNAME/youtubetb-refactored.git
cd youtubetb-refactored
```

##### 4. إنشاء بيئة افتراضية

```batch
python -m venv venv
venv\Scripts\activate
```

##### 5. تثبيت المتطلبات

```batch
pip install --upgrade pip
pip install -r requirements.txt
```

##### 6. تثبيت Playwright

```batch
playwright install chromium
```

---

## 🔓 الخطوة 3: فك تشفير المفاتيح

بعد استنساخ المستودع، نفّذ:

```batch
python scripts\decrypt_secrets.py
```

### سيُطلب منك:
1. **كلمة المرور** التي استخدمتها في التشفير
2. سيتم إنشاء مجلد `secrets/` تلقائياً
3. جميع الملفات المشفرة ستُفك تشفيرها

### ملاحظات مهمة:
- ⚠️ كلمة المرور **حساسة لحالة الأحرف**
- ⚠️ إذا أدخلت كلمة مرور خاطئة، ستحصل على خطأ `InvalidToken`
- ✅ بعد فك التشفير، تحقق من وجود جميع الملفات في `secrets/`

---

## ✅ الخطوة 4: التحقق من التثبيت

```batch
# 1. فعّل البيئة الافتراضية (إذا لم تكن مفعّلة)
venv\Scripts\activate

# 2. اختبر جميع APIs
python scripts\test_all_apis.py

# 3. شغّل البرنامج
python main.py
```

---

## 🔄 سير العمل الكامل (من جهاز لآخر)

### على الجهاز القديم:
```batch
# 1. تشفير المفاتيح
python scripts\encrypt_secrets.py

# 2. رفع على GitHub
git add .
git commit -m "Update project with encrypted secrets"
git push
```

### على الجهاز الجديد:
```batch
# 1. تحميل ملف التثبيت أو استنساخ المستودع
git clone https://github.com/YOUR_USERNAME/youtubetb-refactored.git
cd youtubetb-refactored

# 2. تشغيل التثبيت الشامل (كـ Administrator)
install_complete.bat

# 3. عند السؤال عن فك التشفير، اختر (Y) وأدخل كلمة المرور

# 4. تشغيل البرنامج
python main.py
```

---

## 📁 هيكل الملفات

```
youtubetb_refactored/
├── secrets/                  # ❌ لا يُرفع على GitHub (في .gitignore)
│   ├── api_key.txt
│   ├── cookies.txt
│   ├── client_secret.json
│   └── token.json
│
├── secrets_encrypted/        # ✅ يُرفع على GitHub (آمن)
│   ├── api_key.txt.enc
│   ├── cookies.txt.enc
│   ├── client_secret.json.enc
│   ├── token.json.enc
│   └── encryption_metadata.json
│
├── scripts/
│   ├── encrypt_secrets.py    # سكربت التشفير
│   └── decrypt_secrets.py    # سكربت فك التشفير
│
├── install_complete.bat      # ملف التثبيت الشامل ⭐
└── requirements.txt
```

---

## 🛠️ استكشاف الأخطاء

### مشكلة: "Python not found"
```batch
# الحل:
# 1. تأكد من تثبيت Python 3.11+
# 2. تأكد من إضافة Python لـ PATH
# 3. أعد تشغيل Command Prompt
# 4. جرب: python --version
```

### مشكلة: "FFmpeg not found"
```batch
# الحل:
# 1. تأكد من تثبيت FFmpeg
# 2. تأكد من إضافة FFmpeg لـ PATH
# 3. أعد تشغيل Command Prompt
# 4. جرب: ffmpeg -version
```

### مشكلة: "Invalid password" عند فك التشفير
```batch
# الحل:
# 1. تأكد من كلمة المرور (حساسة لحالة الأحرف)
# 2. تأكد من أنك تستخدم نفس كلمة المرور المستخدمة في التشفير
# 3. إذا نسيت كلمة المرور، ستحتاج لإعادة إنشاء المفاتيح يدوياً
```

### مشكلة: "Administrator rights required"
```batch
# الحل:
# انقر بالزر الأيمن على install_complete.bat
# اختر "Run as administrator"
```

### مشكلة: Playwright installation failed
```batch
# الحل اليدوي:
venv\Scripts\activate
pip install playwright
playwright install chromium
```

---

## 🔐 أمان كلمة المرور

### نصائح مهمة:
- ✅ استخدم كلمة مرور قوية (8+ أحرف، أرقام، رموز)
- ✅ احفظ كلمة المرور في مكان آمن (مدير كلمات مرور)
- ✅ لا تشارك كلمة المرور عبر البريد الإلكتروني
- ⚠️ إذا نسيت كلمة المرور، لن تستطيع فك التشفير!

### في حالة نسيان كلمة المرور:
1. ستحتاج لإعادة إنشاء جميع المفاتيح يدوياً
2. أو استخدام نسخة احتياطية غير مشفرة (إن وُجدت)

---

## 📞 الدعم

إذا واجهت أي مشاكل:
1. تحقق من `docs/TROUBLESHOOTING.md`
2. راجع `docs/QUICK_START.md`
3. افحص ملفات اللوج في `runs/*/pipeline.log`

---

## ✨ ملاحظات إضافية

### ميزات ملف التثبيت الشامل:
- ✅ تثبيت تلقائي كامل بملف واحد
- ✅ فحص الإصدارات والمتطلبات
- ✅ تحميل تلقائي للبرامج المطلوبة
- ✅ إعداد PATH تلقائياً
- ✅ تفعيل البيئة الافتراضية
- ✅ اختبار التثبيت
- ✅ واجهة ملونة وواضحة

### البرامج المثبتة تلقائياً:
1. **Python 3.11.9** (إذا لم يكن موجوداً)
2. **FFmpeg** (أحدث إصدار)
3. **Pip packages** (من requirements.txt)
4. **Playwright Chromium** (للسكرابينج)

### الوقت المتوقع للتثبيت:
- ⏱️ على إنترنت سريع: 5-10 دقائق
- ⏱️ على إنترنت بطيء: 15-20 دقيقة

---

**تم التحديث:** 24 أكتوبر 2025
